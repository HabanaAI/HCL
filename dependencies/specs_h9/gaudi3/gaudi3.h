/* SPDX-License-Identifier: MIT
 *
 * Copyright 2021-2022 HabanaLabs, Ltd.
 * All Rights Reserved.
 *
 */

#ifndef GAUDI3_H
#define GAUDI3_H

#define CFG_BAR_ID		0
#define MSIX_BAR_ID		2
#define SRAM_DRAM_BAR_ID	4

#define CFG_BAR_SIZE		0x10000000ull		/* 256MB */
#define MSIX_BAR_SIZE		0x8000ull		/* 32KB */

#define LBW_BASE		0x0300007FE0000000ull
#define LBW_SIZE		0x0000000020000000ull	/* 512MB */

#define CFG_BASE		0x0300007FFC000000ull
#define CFG_SIZE		0x0000000004000000ull	/* 64MB CFG */

#define DBG_BASE		0x0300007FF8000000ull
#define DBG_SIZE		0x0000000004000000ull	/* 64MB DBG */

#define TPC_DBG_BASE		0x0300007FF0000000ull
#define TPC_DBG_SIZE		0x0000000008000000ull	/* 128MB TPC DBG */

#define FW_MEM_BASE		0x0300007FD0000000ull
#define FW_MEM_SIZE		0x0000000010000000ull	/* 256MB FW-MEM */

#define D0_GLOBAL_STM_BASE	0x0300007FD0000000ull
#define D1_GLOBAL_STM_BASE	0x0300007FD8000000ull
#define GLOBAL_STM_SIZE		0x2000000ull		/* 32MB */

#define CFG_BAR_BASE		TPC_DBG_BASE

#define SRAM_BASE_ADDR		0x0200FFFFF0000000ull
#define SRAM_SIZE		0x0000000010000000ull	/* 256MB */

#define DRAM_PHYS_BASE		0x0201000000000000ull
#define DRAM_MAX_SIZE		0x0001000000000000ull	/* 256TB (48 bits) */

#define HOST_PHYS_BASE_0	0x0000000000000000ull
#define HOST_PHYS_SIZE_0	0x0100000000000000ull	/* 64PB (56 bits) */

#define HOST_PHYS_BASE_1	0xFF00000000000000ull
#define HOST_PHYS_SIZE_1	0x0100000000000000ull	/* 64PB (56 bits) */

#define DRAM_VA_HINT_MASK	0xFFFFFFFFFFFFull	/* 48bit mask */

#define RESERVED_VA_RANGE_FOR_ARC_ON_HBM_START	0x0201E00000000000ull
#define RESERVED_VA_RANGE_FOR_ARC_ON_HBM_END	0x0201FFFFFFFFFFFFull

#define RESERVED_VA_RANGE_FOR_ARC_ON_HOST_START	0xFF70780000000000ull
#define RESERVED_VA_RANGE_FOR_ARC_ON_HOST_END	0xFF707FFFFFFFFFFFull

#define RESERVED_VA_RANGE_FOR_ARC_ON_HOST_HPAGE_START	0xFFF0780000000000ull
#define RESERVED_VA_RANGE_FOR_ARC_ON_HOST_HPAGE_END	0xFFF07FFFFFFFFFFFull

#define MAX_ASID		2

#define NUM_OF_SCHEDULER_ARC	16

#define NUM_ARC_CPUS		120

#define NUM_ACTIVE_ARCS		108			/* excluding NIC ARCs/QMANs */

#define NUM_OF_EDMA_CHANNELS	3

#define MAX_NUM_OF_DIES		2

#define NUM_OF_PDMA_CH_PER_GRP	6

#define NUM_OF_PDMA_GRP_PER_DIE	2

#define NUM_OF_PDMA_GRP		(NUM_OF_PDMA_GRP_PER_DIE * MAX_NUM_OF_DIES)

#define NUM_OF_PDMA_CH		(NUM_OF_PDMA_GRP * NUM_OF_PDMA_CH_PER_GRP)

#define NUM_OF_PDMA_CH_PER_DIE	(NUM_OF_PDMA_GRP_PER_DIE * NUM_OF_PDMA_CH_PER_GRP)

#define RESERVED_MSIX_UNEXPECTED_USER_ERROR_INTERRUPT	127

#define GAUDI3_MSIX_ENTRIES	128

#define NIC_MAX_NUM_OF_MACROS	12

#define NIC_MAX_NUM_OF_ENGINES	NIC_MAX_NUM_OF_MACROS

#define NIC_MIN_LANES_PER_PORT	2

#define NIC_MAX_NUM_OF_PORTS	(NIC_MAX_NUM_OF_ENGINES * \
				 NIC_MAC_NUM_OF_LANES / NIC_MIN_LANES_PER_PORT)

#define NIC_MAX_FIFO_RINGS	24

#define HMMU_TLB_MAX_SUPPORTED_PAGE_TYPES	3

/* DIE */
#define NUM_OF_HDCORES_PER_DIE		4
#define NUM_OF_NRTR_PER_DIE		2
#define NUM_OF_GRTR_PER_DIE		2
#define NUM_OF_NRTR_CTRL_PER_DIE	3
#define NIC_NUM_MACROS_PER_DIE		6
#define NUM_OF_DPHY_CTRL_PER_DIE	6
#define NUM_OF_D2D_MAC_PER_DIE		2
#define NUM_OF_ROTATOR_PER_DIE		4

/* HDCORE */
#define NUM_OF_CACHE_SLICES_PER_HDCORE	8
#define NUM_OF_STLB_PER_HDCORE		1
#define NUM_OF_DTLB_PER_HDCORE		8
#define NUM_OF_RRTR_PER_HDCORE		8
#define NUM_OF_MME_PER_HDCORE		1
#define NUM_OF_TPC_PER_HDCORE		8
#define NUM_OF_EDMA_PER_HDCORE		2
#define NUM_OF_ROTATOR_PER_HDCORE	2
#define NUM_ARC_SCHED_PER_HDCORE	2
#define NUM_OF_DECODER_PER_HDCORE	2

#define NUM_HDCORE0_TPC			(NUM_OF_TPC_PER_HDCORE + 1)
#define NUM_HDCORE1_TPC			NUM_OF_TPC_PER_HDCORE
#define NUM_HDCORE2_TPC			(NUM_OF_TPC_PER_HDCORE + 1)
#define NUM_HDCORE3_TPC			NUM_OF_TPC_PER_HDCORE
#define NUM_HDCORE4_TPC			NUM_OF_TPC_PER_HDCORE
#define NUM_HDCORE5_TPC			(NUM_OF_TPC_PER_HDCORE + 1)
#define NUM_HDCORE6_TPC			NUM_OF_TPC_PER_HDCORE
#define NUM_HDCORE7_TPC			(NUM_OF_TPC_PER_HDCORE + 1)
#define NUM_HDCORES_WITH_9_TPC		4

/* DTLB */
#define NUM_OF_DTLB_PER_RRTR	1
#define NUM_OF_DTLB_PER_NRTR0	3
#define NUM_OF_TRANSLATE_DTLB_PER_NRTR	2
#define NUM_OF_DTLB_PER_NRTR1	2

#define NUM_OF_CBC_RANGES			4
#define NUM_OF_CBC_INVALIDATION_REGS_SETS	5

#define SRAM_MODE_0_OFFSET	0xA000000ull

#define DEVICE_CACHE_LINE_SIZE  256

/* Every engine ARC cpu in the system contains a single DCCM block size 32KB
 * scheduler ARCs contain 2 DCCM blocks 32KB each.
 */
#define ARC_DCCM_BLOCK_SIZE		0x8000

#define NIC_MAC_NUM_OF_LANES	4

#define NIC_MAC_LANES_START	0

#define NIC_CACHE_LINE_SIZE	128

#define NIC_SEND_WQE_SIZE	32

#define NIC_RECV_WQE_SIZE	16

/* we support 1MB, 32MB and 1GB pages */
#define DEV_MEM_ALLOC_NUM_SUPPORTED_PAGE_SIZES	3

#define DB_FIFO_ELEMENT_SIZE	4

#define NIC_HW_MAX_QP_NUM	(1 << 24) /* 16M (per nic) */

#define NIC_MIN_CONN_ID		1

#define NIC_MAX_CONN_ID		((1 << 15) - 1) /* 32K QPs */

#endif /* GAUDI3_H */
